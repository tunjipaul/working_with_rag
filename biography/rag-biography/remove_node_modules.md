# Remove node_modules from Git History

## ‚ö†Ô∏è WARNING

**This will rewrite Git history!** Only do this if:

- You haven't pushed to a shared repository, OR
- You're okay with force-pushing and coordinating with your team

## üìã Steps to Remove node_modules

### Option 1: Using git filter-branch (Built-in)

```bash
# 1. Make sure you're in the repository
cd "c:\Users\hp pc\Desktop\TunjiPaul\working_with_rag\biography\rag-biography"

# 2. Remove node_modules from all commits
git filter-branch --force --index-filter \
  "git rm -rf --cached --ignore-unmatch node_modules" \
  --prune-empty --tag-name-filter cat -- --all

# 3. Clean up references
git for-each-ref --format="delete %(refname)" refs/original | git update-ref --stdin

# 4. Force garbage collection
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# 5. Verify node_modules is gone
git log --all --full-history --oneline -- node_modules

# 6. Force push (if already pushed to remote)
git push origin --force --all
git push origin --force --tags
```

### Option 2: Using BFG Repo-Cleaner (Faster, Recommended)

```bash
# 1. Install BFG (if not installed)
# Download from: https://rtyley.github.io/bfg-repo-cleaner/

# 2. Clone a fresh copy (mirror)
git clone --mirror git@github.com:yourusername/yourrepo.git

# 3. Run BFG to remove node_modules
java -jar bfg.jar --delete-folders node_modules yourrepo.git

# 4. Clean up
cd yourrepo.git
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# 5. Push changes
git push
```

### Option 3: Using git filter-repo (Modern, Best)

```bash
# 1. Install git-filter-repo
pip install git-filter-repo

# 2. Remove node_modules
git filter-repo --path node_modules --invert-paths

# 3. Force push (if already pushed)
git push origin --force --all
```

## üîç PowerShell Commands (Windows)

Since you're on Windows, here's the PowerShell version:

```powershell
# Navigate to repository
cd "c:\Users\hp pc\Desktop\TunjiPaul\working_with_rag\biography\rag-biography"

# Remove node_modules from history
git filter-branch --force --index-filter "git rm -rf --cached --ignore-unmatch node_modules" --prune-empty --tag-name-filter cat -- --all

# Clean up
git for-each-ref --format="delete %(refname)" refs/original | git update-ref --stdin
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# Force push (if needed)
git push origin --force --all
```

## ‚úÖ After Cleanup

1. **Add .gitignore** (you already did this!)

   ```
   node_modules/
   ```

2. **Commit the .gitignore**

   ```bash
   git add .gitignore
   git commit -m "Add node_modules to .gitignore"
   ```

3. **Verify node_modules is ignored**
   ```bash
   git status
   # Should not show node_modules
   ```

## üìä Check Repository Size

```bash
# Before cleanup
git count-objects -vH

# After cleanup (should be smaller)
git count-objects -vH
```

## üö® Important Notes

- **Backup first**: Make a backup of your repository before running these commands
- **Coordinate with team**: If others have cloned the repo, they'll need to re-clone
- **Force push required**: You'll need to force push if you've already pushed to remote
- **One-time operation**: After this, node_modules will be ignored going forward

## üéØ Quick Command (Copy-Paste for PowerShell)

```powershell
git filter-branch --force --index-filter "git rm -rf --cached --ignore-unmatch node_modules" --prune-empty --tag-name-filter cat -- --all && git for-each-ref --format="delete %(refname)" refs/original | git update-ref --stdin && git reflog expire --expire=now --all && git gc --prune=now --aggressive
```
